SELECT T1.ITEM_CD, T1.ITEM_NM, T1.ITEM_TYPE_CD, T6.COMM_DTL_CD_NM AS ITEM_TYPE_NM, T1.ITEM_GRP_CD, T1.ITEM_GRP_NM, T1.ITEM_CTGRI_CD, T1.ITEM_CTGRI_NM, T1.INF_ITEM_YN,
            T1.ITEM_ATTR01_CD, T2.COMM_DTL_CD_NM AS ITEM_ATTR01_NM, T1.ITEM_ATTR02_CD, T3.COMM_DTL_CD_NM AS ITEM_ATTR02_NM, T1.ITEM_ATTR03_CD,
            T4.COMM_DTL_CD_NM AS ITEM_ATTR03_NM, T1.ITEM_ATTR04_CD, T5.COMM_DTL_CD_NM AS ITEM_ATTR04_NM, T1.ITEM_ATTR05_CD, T1.ITEM_ATTR06_CD, T1.ITEM_ATTR07_CD,
            T1.ITEM_ATTR08_CD, T1.ITEM_ATTR09_CD, T1.ITEM_ATTR10_CD, T1.ITEM_ATTR11_CD, T1.ITEM_ATTR12_CD, T1.ITEM_ATTR13_CD, T1.ITEM_ATTR14_CD, T1.ITEM_ATTR15_CD, T1.ITEM_ATTR16_CD,
            T1.ITEM_ATTR17_CD, T1.ITEM_ATTR18_CD, T1.ITEM_ATTR19_CD, T1.ITEM_ATTR20_CD, T1.ITEM_ATTR21_CD, T1.ITEM_ATTR22_CD, T1.ITEM_ATTR23_CD, T1.ITEM_ATTR24_CD, T1.ITEM_ATTR25_CD,
            T1.ITEM_ATTR26_CD, T1.ITEM_ATTR27_CD, T1.ITEM_ATTR28_CD, T1.ITEM_ATTR29_CD, T1.ITEM_ATTR30_CD, T1.DF_ITEM_CD, T1.MILEAGE_CD, T1.PROD_ORDER_CD, T1.PKG_CD,
            T1.PKG_CTGRI_CD, T1.PKG_CTGRI_SUB_CD, T1.ITEM_STRA_CD, T1.ITEM_GRADE, T1.PROD_STRA_CD, T1.PROD_STRA_SUB_CD, T1.DOME_CD, T1.UNIT_PRICE, T1.UNIT_CD, T1.AGING_PERIOD,
            T1.NEW_ITEM_YN, T1.NEW_ITEM_YYMMDD, T1.DESCR, T1.USE_YN, T1.DEL_YN
FROM  dbo.M4S_I002040_IF_DATA AS T1 INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T2 ON T1.ITEM_ATTR01_CD = T2.COMM_DTL_CD AND T2.COMM_CD = 'ITEM_GUBUN01' INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T3 ON T1.ITEM_ATTR02_CD = T3.COMM_DTL_CD AND T3.COMM_CD = 'ITEM_GUBUN02' INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T4 ON T1.ITEM_ATTR03_CD = T4.COMM_DTL_CD AND T4.COMM_CD = 'ITEM_GUBUN03' INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T5 ON T1.ITEM_ATTR04_CD = T5.COMM_DTL_CD AND T5.COMM_CD = 'ITEM_GUBUN04' INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T6 ON T1.ITEM_TYPE_CD = T6.COMM_DTL_CD AND T6.COMM_CD = 'ITEM_TYPE_CD'
WHERE (1 = 1) AND (T1.ITEM_ATTR01_CD IN ('P1', 'P2', 'P6'))


select * from  dbo.m4s_i002040_if_data_bak AS T1
    INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T2 ON T1.ITEM_ATTR01_CD = T2.COMM_DTL_CD AND T2.COMM_CD = 'ITEM_GUBUN01'
    INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T3 ON T1.ITEM_ATTR02_CD = T3.COMM_DTL_CD AND T3.COMM_CD = 'ITEM_GUBUN02'
    INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T4 ON T1.ITEM_ATTR03_CD = T4.COMM_DTL_CD AND T4.COMM_CD = 'ITEM_GUBUN03'
    INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T5 ON T1.ITEM_ATTR04_CD = T5.COMM_DTL_CD AND T5.COMM_CD = 'ITEM_GUBUN04'
    INNER HASH JOIN
            dbo.M4S_I002011_BAK AS T6 ON T1.ITEM_TYPE_CD = T6.COMM_DTL_CD AND T6.COMM_CD = 'ITEM_TYPE_CD'



UPDATE m4s_i002040_if_data_bak
SET ITEM_ATTR01_CD = T1.COMM_DTL_CD1
, ITEM_ATTR02_CD = T1.COMM_DTL_CD2
, ITEM_ATTR03_CD = T1.COMM_DTL_CD3
, ITEM_ATTR04_CD = T1.COMM_DTL_CD4
FROM(SELECT IF_DATA.PROJECT_CD PROJECT
     , ITEM_CD ITEM
     , ITEM_NM
     , ITEM_ATTR01_CD
     , COMM1.COMM_DTL_CD COMM_DTL_CD1
     , ITEM_ATTR02_CD
     , COMM2.COMM_DTL_CD COMM_DTL_CD2
     , ITEM_ATTR03_CD
     , COMM3.COMM_DTL_CD COMM_DTL_CD3
     , ITEM_ATTR04_CD
     , COMM4.COMM_DTL_CD COMM_DTL_CD4
 FROM M4S_I002040_IF_DATA_BAK IF_DATA
  JOIN M4S_I002011_BAK COMM1
    ON COMM1.PROJECT_CD = IF_DATA.PROJECT_CD
   AND COMM1.COMM_CD = 'ITEM_GUBUN01'
   AND COMM1.ATTR02_VAL = IF_DATA.ITEM_ATTR01_CD
  JOIN M4S_I002011_BAK COMM2
    ON COMM2.PROJECT_CD = IF_DATA.PROJECT_CD
   AND COMM2.COMM_CD = 'ITEM_GUBUN02'
   AND COMM2.ATTR02_VAL = IF_DATA.ITEM_ATTR02_CD
  JOIN M4S_I002011_BAK COMM3
    ON COMM3.PROJECT_CD = IF_DATA.PROJECT_CD
   AND COMM3.COMM_CD = 'ITEM_GUBUN03'
   AND COMM3.ATTR02_VAL = IF_DATA.ITEM_ATTR03_CD
  JOIN M4S_I002011_BAK COMM4
    ON COMM4.PROJECT_CD = IF_DATA.PROJECT_CD
   AND COMM4.COMM_CD = 'ITEM_GUBUN04'
   AND COMM4.ATTR02_VAL = IF_DATA.ITEM_ATTR04_CD
WHERE IF_DATA.ITEM_ATTR01_CD IS NOT NULL) T1
WHERE PROJECT_CD = T1.PROJECT
AND ITEM_CD = T1.ITEM

select * from m4s_i002040_if_data_bak WHERE ITEM_ATTR01_CD IS NOT NULL

SELECT * INTO M4S_I002040 FROM m4s_i002040_if_data_bak

DROP TABLE M4S_I002040

ssukb
dev02

SELECT * FROM M4S_I110400

select * from m4s_i204020 where SALES_MGMT_VRSN_ID = '202111_V0'

select * from m4s_i204050 where SALES_MGMT_VRSN_ID = '202111_V0' AND SALES_MGMT_CD LIKE '%1033'


SELECT ISNUMERIC(CUST_GRP_NM), CUST_GRP_NM FROM M4S_I002174 WHERE ISNUMERIC(CUST_GRP_NM) != 0

select * from M4S_O201001_NEW where SALES_MGMT_CD like '%1033' and DP_VRSN_ID = 'SP_2021W52.03'