SELECT SUM(  RST_SALES_QTY ) AS RST_SALES_QTY FROM M4S_I002170 WHERE 1=1
           AND PROJECT_CD = :VS_PROJECT_CD


SELECT * FROM M4S_O110500

SELECT CUST.PROJECT_CD
     , CUST.CUST_CD
     , CUST.CUST_GRP_CD
     , ISNULL(SP1.LINK_SALES_MGMT_NM,'-') SALES_MGMT_NM
  FROM M4S_I002060 CUST
LEFT OUTER JOIN M4S_I204020 SP1
    ON CUST.PROJECT_CD = SP1.PROJECT_CD
   AND CUST.CUST_GRP_CD = SP1.LINK_SALES_MGMT_CD
   AND SP1.SALES_MGMT_VRSN_ID = '202111_V0'
   AND SP1.SALES_MGMT_TYPE_CD = 'SP1'
 WHERE CUST.PROJECT_CD = :VS_PROJECT_CD


SELECT RST.SOLD_CUST_GRP_CD
     , RST.ITEM_CD
     , RST.YYMMDD
     , RST.WEEK
     , SUM(  RST.RST_SALES_QTY ) AS RST_SALES_QTY
  FROM M4S_I002170 RST  -- SELL_IN
-- JOIN (
--       SELECT CUST.PROJECT_CD
--      , CUST.CUST_CD
--      , CUST.CUST_GRP_CD
--      , ISNULL(SP1.LINK_SALES_MGMT_NM,'-') SALES_MGMT_NM
--   FROM M4S_I002060 CUST
-- LEFT OUTER JOIN M4S_I204020 SP1
--     ON CUST.PROJECT_CD = SP1.PROJECT_CD
--    AND CUST.CUST_GRP_CD = SP1.LINK_SALES_MGMT_CD
--    AND SP1.SALES_MGMT_VRSN_ID = '202111_V0'
--    AND SP1.SALES_MGMT_TYPE_CD = 'SP1'
--  WHERE CUST.PROJECT_CD = :VS_PROJECT_CD
--     ) CUST
--   ON RST.PROJECT_CD = CUST.PROJECT_CD
--  AND RST.SOLD_CUST_GRP_CD = CUST.CUST_CD
 WHERE 1=1
   AND RST.PROJECT_CD = :VS_PROJECT_CD
   AND SUBSTRING(RST.YYMMDD,1, 6) BETWEEN :VS_YM_FROM AND :VS_YM_TO
 GROUP BY RST.SOLD_CUST_GRP_CD
     , RST.ITEM_CD
     , RST.YYMMDD
     , RST.WEEK


SELECT SOLD_CUST_GRP_CD
			 , ITEM_CD
			 , YYMMDD
			 , WEEK
			 , SUM(  RST_SALES_QTY ) AS RST_SALES_QTY
          FROM M4S_I002170  -- SELL_IN
         WHERE 1=1
           AND PROJECT_CD = :VS_PROJECT_CD
		   AND SUBSTRING(YYMMDD,1, 6) BETWEEN :VS_YM_FROM AND :VS_YM_TO
            --AND SOLD_CUST_GRP_CD IN (SELECT CUST_CD FROM M4S_I002060 WHERE PROJECT_CD = 'ENT001' AND CUST_GRP_CD = '1068')
		 GROUP BY SOLD_CUST_GRP_CD
			 , ITEM_CD
			 , YYMMDD
			 , WEEK


SELECT * FROM M4S_I002175

SELECT DBO.FN_CORR(19.8907
    , 17.250497017892624
    , 14.34668947
    , 7.919627
    , 8.028995
    , 41)


SELECT DBO.FN_CORR(19.8907
    ,17.750519750519732
    ,14.34668947
    ,8.456737
    ,8.192837
    ,41)

SET 19.8907 = 19.8907;
	SET 17.250497017892624 = 17.250497017892624;
	SET 14.34668947 = 14.34668947;
	SET 7.919627 = 7.919627;
	SET 8.028995 = 8.028995;
	SET 41 = 41;
    IF (41*14.34668947-19.8907*19.8907) * (41*7.919627-17.250497017892624*17.250497017892624) = 0
        SET @V_RETURN = 0;
    ELSE
        SET @V_RETURN = ( 41*8.028995 - 19.8907*17.250497017892624 ) / SQRT( (41*14.34668947-19.8907*19.8907) * (41*7.919627-17.250497017892624*17.250497017892624) );



SELECT  ( 41*8.028995 - 19.8907*17.250497017892624 ) / SQRT( (41*14.34668947-19.8907*19.8907) * (41*7.919627-17.250497017892624*17.250497017892624) )


SELECT DBO.FN_CORR(19.8907
    ,17.750519750519732
    ,14.34668947
    ,8.456737
    ,8.192837
    ,41)

SELECT * FROM M4S_O110300

SELECT DISTINCT YYMMDD FROM M4S_I002175 WHERE DIVISION_CD = 'SELL_IN'


SELECT T1.DIVISION_CD
	, T1.ITEM_ATTR01_CD
	, T1.ITEM_ATTR01_NM
	, T1.ITEM_ATTR02_CD
	, T1.ITEM_ATTR02_NM
	, T1.ITEM_ATTR03_CD
	, T1.ITEM_ATTR03_NM
	, T1.ITEM_ATTR04_CD
	, T1.ITEM_ATTR04_NM
	, T1.ITEM_CD
	, T1.ITEM_NM
	, T1.CUST_GRP_CD
	, T2.LINK_SALES_MGMT_NM AS CUST_GRP_NM
	, '실적' as GUBUN
	, '실적' as STAT_CD
    , '실적' as STAT_NM
	, T1.WEEK
	, CAL.YYMMDD
	, SUBSTRING(CAL.YYMMDD,1,4) AS YY
	, SUBSTRING(CAL.YYMMDD,1,6) AS YYMM
	, SUM(T1.RST_SALES_QTY) AS 실적
	, :VS_CB_LVL FKEY
FROM M4S_I002175 T1-- 실적
     LEFT JOIN (
                SELECT T1.LINK_SALES_MGMT_CD
					  ,T1.LINK_SALES_MGMT_NM
			      FROM M4S_I204020 T1
				 WHERE SALES_MGMT_TYPE_CD = 'SP1'
				   AND T1.SALES_MGMT_VRSN_ID = (SELECT SALES_MGMT_VRSN_ID FROM M4S_I204010 WHERE PROJECT_CD=:VS_P_PROJECT_CD AND USE_YN = 'Y')
                ) T2
	ON T1.CUST_GRP_CD = T2.LINK_SALES_MGMT_CD
	JOIN M4S_I002030 CAL
	   ON T1.PROJECT_CD = CAL.PROJECT_CD
	  AND T1.YYMMDD = CAL.YY
	  AND T1.WEEK = CAL.WEEK
WHERE 1=1
  AND T1.PROJECT_CD = :VS_P_PROJECT_CD
  AND T1.DIVISION_CD = :VS_CB_DIVISION
--   AND T1.ITEM_ATTR01_CD IN (@:VS_CB_BIZ)
--   AND T1.ITEM_ATTR02_CD IN (@:VS_CB_LINE)
--   AND T1.ITEM_ATTR03_CD IN (@:VS_CB_BRAND)
GROUP BY  T1.DIVISION_CD
	, T1.ITEM_ATTR01_CD
	, T1.ITEM_ATTR01_NM
	, T1.ITEM_ATTR02_CD
	, T1.ITEM_ATTR02_NM
	, T1.ITEM_ATTR03_CD
	, T1.ITEM_ATTR03_NM
	, T1.ITEM_ATTR04_CD
	, T1.ITEM_ATTR04_NM
	, T1.CUST_GRP_CD
	, T2.LINK_SALES_MGMT_NM
	, T1.ITEM_CD
	, T1.ITEM_NM
	, T1.WEEK
	, CAL.YYMMDD



SELECT * FROM M4S_O110400 WHERE DATA_VRSN_CD = '20180102-20210103' AND ITEM_CD = '5141087'


